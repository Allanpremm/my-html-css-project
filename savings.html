<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Savings Goals</title>
  <link rel="stylesheet" href="css/style.css"/>
  <style>
    .goal-item {
      border: 1px solid #ccc;
      padding: 1rem;
      margin-bottom: 1rem;
      border-radius: 5px;
      background: #f9f9f9;
    }
    .progress-bar {
      background: #ddd;
      height: 20px;
      border-radius: 5px;
      overflow: hidden;
    }
    .progress {
      background: #2ecc71;
      height: 100%;
      color: white;
      text-align: center;
      font-size: 12px;
      line-height: 20px;
    }
    .btn {
      margin-right: 10px;
      padding: 5px 10px;
      cursor: pointer;
      border: none;
      border-radius: 4px;
    }
    .edit-btn {
      background-color: #3498db;
      color: white;
    }
    .delete-btn {
      background-color: #e74c3c;
      color: white;
    }
  </style>
</head>
<body>
  <header><h1>Savings Goals</h1></header>
  <nav>
    <a href="dashboard.html">Dashboard</a>
    <a href="transactions.html">Transactions</a>
  </nav>

  <main class="container">
    <section>
      <h2><span id="formTitle">Add New Goal</span></h2>
      <form id="goalForm">
        <input type="text" id="goalName" placeholder="Goal Name" required />
        <input type="number" id="goalTarget" placeholder="Target Amount ₹" required />
        <input type="number" id="goalSaved" placeholder="Amount Saved ₹" required />
        <button type="submit">Save Goal</button>
      </form>
    </section>

    <section>
      <h2>Your Goals</h2>
      <div id="goalList"></div>
    </section>
  </main>

  <script>
    const goalForm = document.getElementById('goalForm');
    const goalList = document.getElementById('goalList');
    const formTitle = document.getElementById('formTitle');

    let editIndex = -1;

    function renderGoals() {
      const goals = JSON.parse(localStorage.getItem('goals')) || [];
      goalList.innerHTML = '';

      goals.forEach((goal, index) => {
        const pct = Math.min(100, (goal.saved / goal.target) * 100).toFixed(0);
        const div = document.createElement('div');
        div.className = 'goal-item';
        div.innerHTML = `
          <p><strong>${goal.name}</strong>: ₹${goal.saved.toLocaleString('en-IN')} / ₹${goal.target.toLocaleString('en-IN')}</p>
          <div class="progress-bar"><div class="progress" style="width:${pct}%">${pct}%</div></div>
          <br/>
          <button class="btn edit-btn" onclick="editGoal(${index})">✏️ Edit</button>
          <button class="btn delete-btn" onclick="deleteGoal(${index})">❌ Delete</button>
        `;
        goalList.appendChild(div);
      });
    }

    function deleteGoal(index) {
      const goals = JSON.parse(localStorage.getItem('goals')) || [];
      goals.splice(index, 1);
      localStorage.setItem('goals', JSON.stringify(goals));
      renderGoals();
      resetForm();
    }

    function editGoal(index) {
      const goals = JSON.parse(localStorage.getItem('goals')) || [];
      const goal = goals[index];

      document.getElementById('goalName').value = goal.name;
      document.getElementById('goalTarget').value = goal.target;
      document.getElementById('goalSaved').value = goal.saved;

      editIndex = index;
      formTitle.textContent = "Edit Goal";
    }

    function resetForm() {
      goalForm.reset();
      editIndex = -1;
      formTitle.textContent = "Add New Goal";
    }

    goalForm.addEventListener('submit', e => {
      e.preventDefault();
      const name = goalForm.goalName.value;
      const target = parseFloat(goalForm.goalTarget.value);
      const saved = parseFloat(goalForm.goalSaved.value);

      let goals = JSON.parse(localStorage.getItem('goals')) || [];

      if (editIndex > -1) {
        goals[editIndex] = { name, target, saved };
      } else {
        goals.push({ name, target, saved });
      }

      localStorage.setItem('goals', JSON.stringify(goals));
      renderGoals();
      resetForm();
    });

    renderGoals();
  </script>
</body>
</html>
